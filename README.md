# announcement-duty-reminder-on-discord

イベント告知当番用のリマインダーbotです。
ドキュメントからコードまでほぼ全てGoogle Geminiで作りました。

## How To Use

## Step 1: Discordの準備（Webhook URLの取得）
最初に、GASからメッセージを投稿するために必要なWebhook URLを取得します。

1. リマインドを投稿したいDiscordサーバーで、左上のサーバー名をクリックし、「サーバー設定」を選択します。

1. 左側のメニューから「連携サービス」をクリックします。

1. 「ウェブフックを作成」ボタンをクリックします。

1. 新しいWebhookが作成されたら、名前（例: GASリマインダー）と投稿させたいチャンネルを選択します。アバター画像も任意で設定できます。

1. 「ウェブフックURLをコピー」をクリックし、URLを安全な場所に控えておきます。このURLは後でGASのコードに設定します。

## Step 2: Googleスプレッドシートの準備
次に、リマインドの担当者とスケジュールを管理するスプレッドシートを作成します。

1. Googleドライブで新しいスプレッドシートを作成します。

1. シート名を「Config」に変更します。

1. 以下のように1行目に見出しを、2行目以降にデータを入力します。

||A列|B列|C列|D列|E列|
|----|----|----|----|----|----|
|1|DiscordユーザーID|メモ|開始日|終了日|頻度(日)|
|2|987654321098765432|Aさん|2025/09/20|2025/10/31|1|
|3|123456789012345678|Bさん|2025/11/01|2025/11/30|7|
|4|...|...|...|...|...|

1. Google スプレッドシートにエクスポート
  1. DiscordユーザーID: メンションしたいユーザーのID。開発者モードをオンにしてユーザー名を右クリックするとIDをコピーできます。

  1. 開始日/終了日: リマインドを実行する期間。

  1. 頻度(日): 1なら毎日、7なら7日ごと（週一）となります。

## Step 3: Google Apps Scriptの実装

1. 準備したスプレッドシートのメニューから「拡張機能」>「Apps Script」を選択します。

1. 表示されたコードエディタ（コード.gs）の中身をすべて削除し、code.gsのコードをそのまま貼り付けます。

1. 貼り付けたコード内のWebhook URLをご自身の環境に合わせて編集してください。

1. フロッピーディスクのアイコン💾をクリックして、プロジェクトを保存します。

1. 環境変数の反映のため、setConfiguration関数を手動で実行してください。

## Step 4: トリガーを設定して自動化する

1. GASエディタの左側メニューから、目覚まし時計のアイコン⏰「トリガー」をクリックします。

2. 右下の「トリガーを追加」ボタンをクリックします。

3. 以下の通りに設定し、「保存」をクリックします。

  1. 実行する関数を選択: main

  1. 実行するデプロイを選択: Head

  1. イベントのソースを選択: 時間主導型

  1. 時間ベースのトリガーのタイプを選択: 日付ベースのタイマー

  1. 時刻を選択: 午前9時～10時 （など、リマインドしたい時間帯）

4. 初回のみ、Googleアカウントの承認を求められます。自分のアカウントを選択 > 「詳細」をクリック > 「（安全でないページ）に移動」をクリック > 「許可」をクリック、という手順で進めてください。これは、作成したスクリプトにスプレッドシートへのアクセスや外部への通信を許可するために必要な操作です。
