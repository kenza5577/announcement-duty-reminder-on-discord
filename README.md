# announcement-duty-reminder-on-discord

イベント告知当番用のリマインダーbotです
ドキュメントからコードまでほぼ全てGoogle Geminiで作りました

## How To Use

📍 Step 1: Discordの準備（Webhook URLの取得）
最初に、GASからメッセージを投稿するために必要なWebhook URLを取得します。

サーバー設定を開く:

リマインドを投稿したいDiscordサーバーで、左上のサーバー名をクリックし、「サーバー設定」を選択します。

連携サービスへ移動:

左側のメニューから「連携サービス」をクリックします。

Webhookを作成:

「ウェブフックを作成」ボタンをクリックします。

新しいWebhookが作成されたら、名前（例: GASリマインダー）と投稿させたいチャンネルを選択します。

アバター画像も任意で設定できます。

URLをコピー:

「ウェブフックURLをコピー」をクリックし、URLを安全な場所に控えておきます。このURLは後でGASのコードに設定します。

📄 Step 2: Googleスプレッドシートの準備
次に、リマインドの担当者とスケジュールを管理するスプレッドシートを作成します。

新規スプレッドシートを作成:

Googleドライブで新しいスプレッドシートを作成します。

シートの構成:

シート名を「Config」に変更します。

以下のように1行目に見出しを、2行目以降にデータを入力します。

A列	B列	C列	D列	E列
1	DiscordユーザーID	メモ	開始日	終了日	頻度(日)
2	987654321098765432	Aさん	2025/09/20	2025/10/31	1
3	123456789012345678	Bさん	2025/11/01	2025/11/30	7
4	...	...	...	...	...

Google スプレッドシートにエクスポート
DiscordユーザーID: メンションしたいユーザーのID。開発者モードをオンにしてユーザー名を右クリックするとIDをコピーできます。

開始日/終了日: リマインドを実行する期間。

頻度(日): 1なら毎日、7なら7日ごと（週一）となります。

💻 Step 3: Google Apps Scriptの実装
いよいよGASのコードを記述します。

スクリプトエディタを開く:

準備したスプレッドシートのメニューから「拡張機能」>「Apps Script」を選択します。

コードを貼り付け:

表示されたコードエディタ（コード.gs）の中身をすべて削除し、code.gsのコードをそのまま貼り付けます。

設定項目を編集:

貼り付けたコード内のWebhook URLをご自身の環境に合わせて編集してください。

プロジェクトを保存:

フロッピーディスクのアイコン💾をクリックして、プロジェクトを保存します。

⏰ Step 4: トリガーを設定して自動化する
最後に、このスクリプトを毎日決まった時間に自動で実行するための「トリガー」を設定します。

トリガー画面を開く:

GASエディタの左側メニューから、目覚まし時計のアイコン⏰「トリガー」をクリックします。

トリガーを追加:

右下の「トリガーを追加」ボタンをクリックします。

トリガーを設定:

以下の通りに設定し、「保存」をクリックします。

実行する関数を選択: sendReminder

実行するデプロイを選択: Head

イベントのソースを選択: 時間主導型

時間ベースのトリガーのタイプを選択: 日付ベースのタイマー

時刻を選択: 午前9時～10時 （など、リマインドしたい時間帯）

承認プロセス:

初回のみ、Googleアカウントの承認を求められます。

自分のアカウントを選択 > 「詳細」をクリック > 「（安全でないページ）に移動」をクリック > 「許可」をクリック、という手順で進めてください。これは、作成したスクリプトにスプレッドシートへのアクセスや外部への通信を許可するために必要な操作です。
